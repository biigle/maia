(()=>{var t,e={566:(t,e,n)=>{"use strict";const i=Vue.resource("api/v1/volumes/filter/area-knowledge-transfer"),s=Vue.resource("api/v1/volumes/filter/knowledge-transfer");var o=biigle.$require("annotations.components.annotationCanvas"),r=biigle.$require("largo.mixins.annotationPatch"),a=biigle.$require("annotations.ol.AttachLabelInteraction"),h=biigle.$require("messages").handleErrorResponse,u=biigle.$require("volumes.components.imageGrid"),l=biigle.$require("volumes.components.imageGridImage"),c=biigle.$require("annotations.stores.images"),d=biigle.$require("keyboard"),p=biigle.$require("labelTrees.components.labelTrees"),f=biigle.$require("labelTrees.components.labelTypeahead"),g=biigle.$require("core.mixins.loader"),m=biigle.$require("messages"),_=biigle.$require("core.components.sidebar"),v=biigle.$require("core.components.sidebarTab"),y=biigle.$require("annotations.stores.styles");function I(t,e,n,i,s,o,r,a){var h,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=n,u._compiled=!0),i&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),r?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},u._ssrRegister=h):s&&(h=a?function(){s.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:s),h)if(u.functional){u._injectStyles=h;var l=u.render;u.render=function(t,e){return h.call(e),l(t,e)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,h):[h]}return{exports:t,options:u}}const C=I({mixins:[g],components:{typeahead:f},data:function(){return{volumeId:null,showAdvanced:!1,shouldFetchLabels:!1,labels:[],selectedLabels:[],submitted:!1,trainScheme:[],trainingDataMethod:"",distanceKnowledgeTransferVolumes:[],areaKnowledgeTransferVolumes:[],knowledgeTransferVolume:null,shouldFetchAreaKnowledgeTransferVolumes:!1,shouldFetchDistanceKnowledgeTransferVolumes:!1,knowledgeTransferLabelCache:[],selectedKnowledgeTransferLabels:[]}},computed:{hasLabels:function(){return this.labels.length>0},hasSelectedLabels:function(){return this.selectedLabels.length>0},useExistingAnnotations:function(){return"own_annotations"===this.trainingDataMethod},useNoveltyDetection:function(){return"novelty_detection"===this.trainingDataMethod},useKnowledgeTransfer:function(){return"knowledge_transfer"===this.trainingDataMethod||"area_knowledge_transfer"===this.trainingDataMethod},canSubmit:function(){return this.submitted||this.useKnowledgeTransfer&&!this.knowledgeTransferVolume},knowledgeTransferVolumes:function(){return"area_knowledge_transfer"===this.trainingDataMethod?this.areaKnowledgeTransferVolumes:this.distanceKnowledgeTransferVolumes},shouldFetchKnowledgeTransferVolumes:function(){return this.shouldFetchDistanceKnowledgeTransferVolumes||this.shouldFetchAreaKnowledgeTransferVolumes},hasNoKnowledgeTransferVolumes:function(){return this.shouldFetchKnowledgeTransferVolumes&&!this.loading&&0===this.knowledgeTransferVolumes.length},hasSelectedKnowledgeTransferLabels:function(){return this.selectedKnowledgeTransferLabels.length>0},knowledgeTransferLabels:function(){if(!this.knowledgeTransferVolume)return[];var t=this.knowledgeTransferVolume.id;return this.knowledgeTransferLabelCache.hasOwnProperty(t)||this.fetchKnowledgeTransferLabels(t),this.knowledgeTransferLabelCache[t]}},methods:{toggle:function(){this.showAdvanced=!this.showAdvanced},setLabels:function(t){this.labels=t.body},handleSelectedLabel:function(t){-1===this.selectedLabels.indexOf(t)&&this.selectedLabels.push(t)},handleUnselectLabel:function(t){var e=this.selectedLabels.indexOf(t);e>=0&&this.selectedLabels.splice(e,1)},submit:function(){this.submitted=!0},removeTrainStep:function(t){this.trainScheme.splice(t,1)},addTrainStep:function(){var t={layers:"heads",epochs:10,learning_rate:.001};if(this.trainScheme.length>0){var e=this.trainScheme[this.trainScheme.length-1];t.layers=e.layers,t.epochs=e.epochs,t.learning_rate=e.learning_rate}this.trainScheme.push(t)},handleSelectedKnowledgeTransferVolume:function(t){this.knowledgeTransferVolume=t,this.selectedKnowledgeTransferLabels=[]},parseKnowledgeTransferVolumes:function(t){var e=this;return t.body.filter((function(t){return t.id!==e.volumeId})).map((function(t){return t.description=t.projects.map((function(t){return t.name})).join(", "),t}))},fetchLabels:function(t){this.startLoading();var e=this.$http.get("api/v1/volumes{/id}/annotation-labels",{params:{id:t}});return e.finally(this.finishLoading),e},fetchKnowledgeTransferLabels:function(t){var e=this;this.fetchLabels(t).then((function(n){e.knowledgeTransferLabelCache[t]=n.body}),h)},handleSelectedKnowledgeTransferLabel:function(t){-1===this.selectedKnowledgeTransferLabels.indexOf(t)&&this.selectedKnowledgeTransferLabels.push(t)},handleUnselectKnowledgeTransferLabel:function(t){var e=this.selectedKnowledgeTransferLabels.indexOf(t);e>=0&&this.selectedKnowledgeTransferLabels.splice(e,1)}},watch:{useExistingAnnotations:function(t){t&&(this.shouldFetchLabels=!0)},shouldFetchLabels:function(t){t&&this.fetchLabels(this.volumeId).then(this.setLabels,h)},trainingDataMethod:function(t,e){"knowledge_transfer"===t?this.shouldFetchDistanceKnowledgeTransferVolumes=!0:"area_knowledge_transfer"===t&&(this.shouldFetchAreaKnowledgeTransferVolumes=!0),"knowledge_transfer"!==e&&"area_knowledge_transfer"!==e||(this.knowledgeTransferVolume=null,this.selectedKnowledgeTransferLabels=[],this.$refs.ktTypeahead.clear())},shouldFetchDistanceKnowledgeTransferVolumes:function(t){var e=this;t&&(this.startLoading(),s.get().then(this.parseKnowledgeTransferVolumes,h).then((function(t){return e.distanceKnowledgeTransferVolumes=t})).finally(this.finishLoading))},shouldFetchAreaKnowledgeTransferVolumes:function(t){var e=this;t&&(this.startLoading(),i.get().then(this.parseKnowledgeTransferVolumes,h).then((function(t){return e.areaKnowledgeTransferVolumes=t})).finally(this.finishLoading))}},created:function(){this.volumeId=biigle.$require("maia.volumeId"),this.trainScheme=biigle.$require("maia.trainScheme"),this.showAdvanced=biigle.$require("maia.hasErrors"),this.trainingDataMethod=biigle.$require("maia.trainingDataMethod"),this.useExistingAnnotations&&(this.shouldFetchLabels=!0)}},undefined,undefined,!1,null,null,null).exports,x=Vue.resource("api/v1/maia/annotation-candidates{/id}");var b=I({mixins:[l,r],computed:{label:function(){return this.selected?this.image.label:null},selected:function(){return this.$parent.isSelected(this.image)},converted:function(){return this.$parent.isConverted(this.image)},classObject:function(){return{"image-grid__image--selected":this.selected||this.converted,"image-grid__image--selectable":this.selectable,"image-grid__image--fade":this.selectedFade,"image-grid__image--small-icon":this.smallIcon}},iconClass:function(){return this.converted?"fa-lock":"fa-"+this.selectedIcon},showIcon:function(){return this.selectable||this.selected||this.converted},title:function(){return this.converted?"This annotation candidate has been converted":this.selected?"Detach label":"Attach selected label"},labelStyle:function(){return{"background-color":"#"+this.label.color}},id:function(){return this.image.id},uuid:function(){return this.image.uuid},urlTemplate:function(){return biigle.$require("maia.acUrlTemplate")}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("figure",{staticClass:"image-grid__image image-grid__image--annotation-candidate",class:t.classObject,attrs:{title:t.title}},[t.showIcon?n("div",{staticClass:"image-icon"},[n("i",{staticClass:"fas",class:t.iconClass})]):t._e(),t._v(" "),n("img",{attrs:{src:t.srcUrl},on:{click:t.toggleSelect,error:t.showEmptyImage}}),t._v(" "),t.selected?n("div",{staticClass:"attached-label"},[n("span",{staticClass:"attached-label__color",style:t.labelStyle}),t._v(" "),n("span",{staticClass:"attached-label__name",domProps:{textContent:t._s(t.label.name)}})]):t._e()])}),[],!1,null,null,null);const P=I({mixins:[u],components:{imageGridImage:b.exports},props:{selectedCandidateIds:{type:Object,required:!0},convertedCandidateIds:{type:Object,required:!0}},methods:{isSelected:function(t){return this.selectedCandidateIds.hasOwnProperty(t.id)},isConverted:function(t){return this.convertedCandidateIds.hasOwnProperty(t.id)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"image-grid",on:{wheel:function(e){return e.preventDefault(),t.scroll.apply(null,arguments)}}},[n("div",{ref:"images",staticClass:"image-grid__images"},t._l(t.displayedImages,(function(e){return n("image-grid-image",{key:e.id,attrs:{image:e,"empty-url":t.emptyUrl,selectable:!t.isConverted(e),"selected-icon":t.selectedIcon},on:{select:t.emitSelect}})})),1),t._v(" "),t.canScroll?n("image-grid-progress",{attrs:{progress:t.progress},on:{top:t.jumpToStart,"prev-page":t.reversePage,"prev-row":t.reverseRow,jump:t.jumpToPercent,"next-row":t.advanceRow,"next-page":t.advancePage,bottom:t.jumpToEnd}}):t._e()],1)}),[],!1,null,null,null).exports,w=Vue.resource("api/v1/maia-jobs{/id}",{},{save:{method:"POST",url:"api/v1/volumes{/id}/maia-jobs"},getTrainingProposals:{method:"GET",url:"api/v1/maia-jobs{/id}/training-proposals"},getTrainingProposalPoints:{method:"GET",url:"api/v1/maia-jobs{/jobId}/images{/imageId}/training-proposals"},getAnnotationCandidates:{method:"GET",url:"api/v1/maia-jobs{/id}/annotation-candidates"},getAnnotationCandidatePoints:{method:"GET",url:"api/v1/maia-jobs{/jobId}/images{/imageId}/annotation-candidates"},convertAnnotationCandidates:{method:"POST",url:"api/v1/maia-jobs{/id}/annotation-candidates"},convertingAnnotationCandidates:{method:"GET",url:"api/v1/maia-jobs{/id}/converting-candidates"}}),S=Vue.resource("api/v1/maia/training-proposals{/id}");var A=I({mixins:[l,r],computed:{label:function(){return this.image.label},labelExists:function(){return this.image.label},selected:function(){return this.$parent.selectedProposalIds.hasOwnProperty(this.image.id)},title:function(){return this.selectable?this.selected?"Unselect as interesting":"Select as interesting":""},id:function(){return this.image.id},uuid:function(){return this.image.uuid},labelStyle:function(){return{"background-color":"#"+this.label.color}},urlTemplate:function(){return biigle.$require("maia.tpUrlTemplate")}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("figure",{staticClass:"image-grid__image image-grid__image--annotation-candidate",class:t.classObject,attrs:{title:t.title}},[t.showIcon?n("div",{staticClass:"image-icon"},[n("i",{staticClass:"fas",class:t.iconClass})]):t._e(),t._v(" "),n("img",{attrs:{src:t.srcUrl},on:{click:t.toggleSelect,error:t.showEmptyImage}}),t._v(" "),t.labelExists?n("div",{staticClass:"attached-label"},[n("span",{staticClass:"attached-label__color",style:t.labelStyle}),t._v(" "),n("span",{staticClass:"attached-label__name",domProps:{textContent:t._s(t.label.name)}})]):t._e()])}),[],!1,null,null,null);const T=I({mixins:[u],components:{imageGridImage:A.exports},props:{selectedProposalIds:{type:Object,required:!0}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"image-grid",on:{wheel:function(e){return e.preventDefault(),t.scroll.apply(null,arguments)}}},[n("div",{ref:"images",staticClass:"image-grid__images"},t._l(t.displayedImages,(function(e){return n("image-grid-image",{key:e.id,attrs:{image:e,"empty-url":t.emptyUrl,selectable:t.selectable,"selected-fade":t.selectable,"small-icon":!t.selectable,"selected-icon":t.selectedIcon},on:{select:t.emitSelect}})})),1),t._v(" "),t.canScroll?n("image-grid-progress",{attrs:{progress:t.progress},on:{top:t.jumpToStart,"prev-page":t.reversePage,"prev-row":t.reverseRow,jump:t.jumpToPercent,"next-row":t.advanceRow,"next-page":t.advancePage,bottom:t.jumpToEnd}}):t._e()],1)}),[],!1,null,null,null).exports;function E(){return function(){throw new Error("Unimplemented abstract method.")}()}var F=0;function L(t){return t.ol_uid||(t.ol_uid=String(++F))}var O="5.3.3";const k=function(t){function e(e){var n="Assertion failed. See https://openlayers.org/en/"+("v"+O.split("-")[0])+"/doc/errors/#"+e+" for details.";t.call(this,n),this.code=e,this.name="AssertionError",this.message=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),M="add",R="remove",D="propertychange";var j="function"==typeof Object.assign?Object.assign:function(t,e){var n=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),s=1,o=arguments.length;s<o;++s){var r=n[s];if(null!=r)for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])}return i};function X(t){for(var e in t)delete t[e]}function V(t){var e;for(e in t)return!1;return!e}function G(t,e,n,i){for(var s,o=0,r=t.length;o<r;++o)if((s=t[o]).listener===e&&s.bindTo===n)return i&&(s.deleteIndex=o),s}function K(t,e){var n=$(t);return n?n[e]:void 0}function $(t,e){var n=t.ol_lm;return!n&&e&&(n=t.ol_lm={}),n}function B(t,e){var n=K(t,e);if(n){for(var i=0,s=n.length;i<s;++i)t.removeEventListener(e,n[i].boundListener),X(n[i]);n.length=0;var o=$(t);o&&(delete o[e],0===Object.keys(o).length&&function(t){delete t.ol_lm}(t))}}function q(t,e,n,i,s){var o=$(t,!0),r=o[e];r||(r=o[e]=[]);var a=G(r,n,i,!1);return a?s||(a.callOnce=!1):(a={bindTo:i,callOnce:!!s,listener:n,target:t,type:e},t.addEventListener(e,function(t){var e=function(e){var n=t.listener,i=t.bindTo||t.target;return t.callOnce&&z(t),n.call(i,e)};return t.boundListener=e,e}(a)),r.push(a)),a}function Y(t,e,n,i){return q(t,e,n,i,!0)}function W(t,e,n,i){var s=K(t,e);if(s){var o=G(s,n,i,!0);o&&z(o)}}function z(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=K(t.target,t.type);if(e){var n="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==n&&e.splice(n,1),0===e.length&&B(t.target,t.type)}X(t)}}var U=function(){this.disposed_=!1};U.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},U.prototype.disposeInternal=function(){};const N=U;function J(){return!0}function H(){}var Z=function(t){this.propagationStopped,this.type=t,this.target=null};Z.prototype.preventDefault=function(){this.propagationStopped=!0},Z.prototype.stopPropagation=function(){this.propagationStopped=!0};const Q=Z;var tt=function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addEventListener=function(t,e){var n=this.listeners_[t];n||(n=this.listeners_[t]=[]),-1===n.indexOf(e)&&n.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Q(t):t,n=e.type;e.target=this;var i,s=this.listeners_[n];if(s){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var o=0,r=s.length;o<r;++o)if(!1===s[o].call(this,e)||e.propagationStopped){i=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var a=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];a--;)this.removeEventListener(n,H);delete this.dispatching_[n]}return i}},e.prototype.disposeInternal=function(){!function(t){var e=$(t);if(e)for(var n in e)B(t,n)}(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var n=this.listeners_[t];if(n){var i=n.indexOf(e);t in this.pendingRemovals_?(n[i]=H,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t])}},e}(N);const et=tt,nt="change",it="clear";const st=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent(nt)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var n=t.length,i=new Array(n),s=0;s<n;++s)i[s]=q(this,t[s],e);return i}return q(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var n=t.length,i=new Array(n),s=0;s<n;++s)i[s]=Y(this,t[s],e);return i}return Y(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var n=0,i=t.length;n<i;++n)W(this,t[n],e);else W(this,t,e)},e}(et);var ot=function(t){function e(e,n,i){t.call(this,e),this.key=n,this.oldValue=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Q),rt=function(t){function e(e){t.call(this),L(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return j({},this.values_)},e.prototype.notify=function(t,e){var n;n=ht(t),this.dispatchEvent(new ot(n,t,e)),n=D,this.dispatchEvent(new ot(n,t,e))},e.prototype.set=function(t,e,n){if(n)this.values_[t]=e;else{var i=this.values_[t];this.values_[t]=e,i!==e&&this.notify(t,i)}},e.prototype.setProperties=function(t,e){for(var n in t)this.set(n,t[n],e)},e.prototype.unset=function(t,e){if(t in this.values_){var n=this.values_[t];delete this.values_[t],e||this.notify(t,n)}},e}(st),at={};function ht(t){return at.hasOwnProperty(t)?at[t]:at[t]="change:"+t}const ut=rt;var lt="length",ct=function(t){function e(e,n){t.call(this,e),this.element=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Q),dt=function(t){function e(e,n){t.call(this);var i=n||{};if(this.unique_=!!i.unique,this.array_=e||[],this.unique_)for(var s=0,o=this.array_.length;s<o;++s)this.assertUnique_(this.array_[s],s);this.updateLength_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,n=t.length;e<n;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)t(e[n],n,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(lt)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new ct(M,e))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)if(e[n]===t)return this.removeAt(n)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new ct(R,e)),e},e.prototype.setAt=function(t,e){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(e,t);var i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new ct(R,i)),this.dispatchEvent(new ct(M,e))}else{for(var s=n;s<t;++s)this.insertAt(s,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(lt,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new k(58)},e}(ut);const pt=dt,ft="VECTOR",gt="opacity",mt="visible",_t="extent",vt="zIndex",yt="maxResolution",It="minResolution",Ct="source";function xt(t,e,n){return Math.min(Math.max(t,e),n)}var bt="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};var Pt=function(t){function e(e){t.call(this);var n=j({},e);n[gt]=void 0!==e.opacity?e.opacity:1,n[mt]=void 0===e.visible||e.visible,n[vt]=e.zIndex,n[yt]=void 0!==e.maxResolution?e.maxResolution:1/0,n[It]=void 0!==e.minResolution?e.minResolution:0,this.setProperties(n),this.state_=null,this.type}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return this.type},e.prototype.getLayerState=function(){var t=this.state_||{layer:this,managed:!0};return t.opacity=xt(this.getOpacity(),0,1),t.sourceState=this.getSourceState(),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=this.getZIndex()||0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),this.state_=t,t},e.prototype.getLayersArray=function(t){return E()},e.prototype.getLayerStatesArray=function(t){return E()},e.prototype.getExtent=function(){return this.get(_t)},e.prototype.getMaxResolution=function(){return this.get(yt)},e.prototype.getMinResolution=function(){return this.get(It)},e.prototype.getOpacity=function(){return this.get(gt)},e.prototype.getSourceState=function(){return E()},e.prototype.getVisible=function(){return this.get(mt)},e.prototype.getZIndex=function(){return this.get(vt)},e.prototype.setExtent=function(t){this.set(_t,t)},e.prototype.setMaxResolution=function(t){this.set(yt,t)},e.prototype.setMinResolution=function(t){this.set(It,t)},e.prototype.setOpacity=function(t){this.set(gt,t)},e.prototype.setVisible=function(t){this.set(mt,t)},e.prototype.setZIndex=function(t){this.set(vt,t)},e}(ut);const wt="precompose",St="undefined",At="ready";var Tt=function(t){function e(e){var n=j({},e);delete n.source,t.call(this,n),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),q(this,ht(Ct),this.handleSourcePropertyChange_,this);var i=e.source?e.source:null;this.setSource(i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(Ct)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():St},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(z(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=q(t,nt,this.handleSourceChange_,this)),this.changed()},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(z(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(z(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=q(t,wt,(function(t){var e=t,n=this.getLayerState();n.managed=!1,void 0===this.getZIndex()&&(n.zIndex=1/0),e.frameState.layerStatesArray.push(n),e.frameState.layerStates[L(this)]=n}),this),this.mapRenderKey_=q(this,nt,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Ct,t)},e}(Pt);const Et=Tt,Ft="vector";function Lt(t,e){if(!t)throw new k(e)}var Ot=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,kt=/^([a-z]*)$/i;function Mt(t){return"string"==typeof t?t:Dt(t)}!function(){var t={},e=0}();function Rt(t){return t[0]=xt(t[0]+.5|0,0,255),t[1]=xt(t[1]+.5|0,0,255),t[2]=xt(t[2]+.5|0,0,255),t[3]=xt(t[3],0,1),t}function Dt(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var i=t[2];return i!=(0|i)&&(i=i+.5|0),"rgba("+e+","+n+","+i+","+(void 0===t[3]?1:t[3])+")"}function jt(t){return Array.isArray(t)?Dt(t):t}function Xt(t,e){var n=document.createElement("canvas");return t&&(n.width=t),e&&(n.height=e),n.getContext("2d")}var Vt="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",Gt=(Vt.indexOf("firefox"),-1!==Vt.indexOf("safari")&&Vt.indexOf("chrom"),-1!==Vt.indexOf("webkit")&&Vt.indexOf("edge"),Vt.indexOf("macintosh"),window.devicePixelRatio,function(){var t=!1;try{t=!!document.createElement("canvas").getContext("2d").setLineDash}catch(t){}return t}());navigator,window,window,navigator.msPointerEnabled;const Kt=2;var $t=function(){var t,e={};return function(n){if(t||(t=document.createElement("div").style),!(n in e)){t.font=n;var i=t.fontFamily;if(t.font="",!i)return null;e[n]=i.split(/,\s?/)}return e[n]}}();const Bt=function(t){function e(e){t.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(it)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t,e){for(var n=this.oldest_;n;)t.call(e,n.value_,n.key_,this),n=n.newer},e.prototype.get=function(t){var e=this.entries_[t];return Lt(void 0!==e,15),e===this.newest_||(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e),e.value_},e.prototype.remove=function(t){var e=this.entries_[t];return Lt(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){Lt(!(t in this.entries_),16);var n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},e}(et);new Array(6);var qt=[0,0,0,1],Yt=[0,0,0,1],Wt=new Bt,zt={},Ut=null,Nt={};!function(){var t,e,n=zt,i="32px ",s=["monospace","serif"],o=s.length,r="wmytzilWMYTZIL@#/&?$%10";function a(t){for(var n=Jt(),a=100;a<=700;a+=300){for(var h=a+" ",u=!0,l=0;l<o;++l){var c=s[l];if(n.font=h+i+c,e=n.measureText(r).width,t!=c){n.font=h+i+t+","+c;var d=n.measureText(r).width;u=u&&d!=e}}if(u)return!0}return!1}function h(){var e=!0;for(var i in n)n[i]<60&&(a(i)?(n[i]=60,X(Nt),Ut=null,Wt.clear()):(++n[i],e=!1));e&&(clearInterval(t),t=void 0)}}();function Jt(){return Ut||(Ut=Xt(1,1)),Ut}var Ht,Zt;Zt=Nt;var Qt=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale};Qt.prototype.clone=function(){return new Qt({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},Qt.prototype.getOpacity=function(){return this.opacity_},Qt.prototype.getRotateWithView=function(){return this.rotateWithView_},Qt.prototype.getRotation=function(){return this.rotation_},Qt.prototype.getScale=function(){return this.scale_},Qt.prototype.getSnapToPixel=function(){return!1},Qt.prototype.getAnchor=function(){return E()},Qt.prototype.getImage=function(t){return E()},Qt.prototype.getHitDetectionImage=function(t){return E()},Qt.prototype.getImageState=function(){return E()},Qt.prototype.getImageSize=function(){return E()},Qt.prototype.getHitDetectionImageSize=function(){return E()},Qt.prototype.getOrigin=function(){return E()},Qt.prototype.getSize=function(){return E()},Qt.prototype.setOpacity=function(t){this.opacity_=t},Qt.prototype.setRotateWithView=function(t){this.rotateWithView_=t},Qt.prototype.setRotation=function(t){this.rotation_=t},Qt.prototype.setScale=function(t){this.scale_=t},Qt.prototype.setSnapToPixel=function(t){},Qt.prototype.listenImageChange=function(t,e){return E()},Qt.prototype.load=function(){E()},Qt.prototype.unlistenImageChange=function(t,e){E()};var te=function(t){function e(e){var n=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==e.rotation?e.rotation:0,scale:1}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=void 0!==e.radius?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=e.atlasManager,this.render_(this.atlasManager_)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return Kt},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t,e){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t,e){},e.prototype.render_=function(t){var e,n,i="",s="",o=0,r=null,a=0,h=0;this.stroke_&&(null===(n=this.stroke_.getColor())&&(n=Yt),n=jt(n),void 0===(h=this.stroke_.getWidth())&&(h=1),r=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),Gt||(r=null,a=0),void 0===(s=this.stroke_.getLineJoin())&&(s="round"),void 0===(i=this.stroke_.getLineCap())&&(i="round"),void 0===(o=this.stroke_.getMiterLimit())&&(o=10));var u=2*(this.radius_+h)+1,l={strokeStyle:n,strokeWidth:h,size:u,lineCap:i,lineDash:r,lineDashOffset:a,lineJoin:s,miterLimit:o};if(void 0===t){var c=Xt(u,u);this.canvas_=c.canvas,e=u=this.canvas_.width,this.draw_(l,c,0,0),this.createHitDetectionCanvas_(l)}else{u=Math.round(u);var d,p=!this.fill_;p&&(d=this.drawHitDetectionCanvas_.bind(this,l));var f=this.getChecksum(),g=t.add(f,u,u,this.draw_.bind(this,l),d);this.canvas_=g.image,this.origin_=[g.offsetX,g.offsetY],e=g.image.width,p?(this.hitDetectionCanvas_=g.hitImage,this.hitDetectionImageSize_=[g.hitImage.width,g.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[u/2,u/2],this.size_=[u,u],this.imageSize_=[e,e]},e.prototype.draw_=function(t,e,n,i){var s,o,r;e.setTransform(1,0,0,1,0,0),e.translate(n,i),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(a*=2),s=0;s<=a;s++)o=2*s*Math.PI/a-Math.PI/2+this.angle_,r=s%2==0?this.radius_:h,e.lineTo(t.size/2+r*Math.cos(o),t.size/2+r*Math.sin(o))}if(this.fill_){var u=this.fill_.getColor();null===u&&(u=qt),e.fillStyle=jt(u),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=Xt(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},e.prototype.drawHitDetectionCanvas_=function(t,e,n,i){e.setTransform(1,0,0,1,0,0),e.translate(n,i),e.beginPath();var s=this.points_;if(s===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o,r,a,h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(s*=2),o=0;o<=s;o++)a=2*o*Math.PI/s-Math.PI/2+this.angle_,r=o%2==0?this.radius_:h,e.lineTo(t.size/2+r*Math.cos(a),t.size/2+r*Math.sin(a))}e.fillStyle=Mt(qt),e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var n="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[n,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},e}(Qt);var ee=function(t){function e(e){var n=e||{};t.call(this,{points:1/0,fill:n.fill,radius:n.radius,stroke:n.stroke,atlasManager:n.atlasManager})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},e}(te);const ne=ee;var ie=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};ie.prototype.clone=function(){var t=this.getColor();return new ie({color:Array.isArray(t)?t.slice():t||void 0})},ie.prototype.getColor=function(){return this.color_},ie.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},ie.prototype.getChecksum=function(){if(void 0===this.checksum_){var t=this.color_;t?Array.isArray(t)||"string"==typeof t?this.checksum_="f"+Mt(t):this.checksum_=L(this.color_):this.checksum_="f-"}return this.checksum_};const se=ie;var oe=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};oe.prototype.clone=function(){var t=this.getColor();return new oe({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},oe.prototype.getColor=function(){return this.color_},oe.prototype.getLineCap=function(){return this.lineCap_},oe.prototype.getLineDash=function(){return this.lineDash_},oe.prototype.getLineDashOffset=function(){return this.lineDashOffset_},oe.prototype.getLineJoin=function(){return this.lineJoin_},oe.prototype.getMiterLimit=function(){return this.miterLimit_},oe.prototype.getWidth=function(){return this.width_},oe.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},oe.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},oe.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},oe.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},oe.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},oe.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},oe.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},oe.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=L(this.color_):this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};const re=oe;var ae=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=le,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};ae.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new ae({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},ae.prototype.getRenderer=function(){return this.renderer_},ae.prototype.setRenderer=function(t){this.renderer_=t},ae.prototype.getGeometry=function(){return this.geometry_},ae.prototype.getGeometryFunction=function(){return this.geometryFunction_},ae.prototype.getFill=function(){return this.fill_},ae.prototype.setFill=function(t){this.fill_=t},ae.prototype.getImage=function(){return this.image_},ae.prototype.setImage=function(t){this.image_=t},ae.prototype.getStroke=function(){return this.stroke_},ae.prototype.setStroke=function(t){this.stroke_=t},ae.prototype.getText=function(){return this.text_},ae.prototype.setText=function(t){this.text_=t},ae.prototype.getZIndex=function(){return this.zIndex_},ae.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=le,this.geometry_=t},ae.prototype.setZIndex=function(t){this.zIndex_=t};var he=null;function ue(t,e){if(!he){var n=new se({color:"rgba(255,255,255,0.4)"}),i=new re({color:"#3399CC",width:1.25});he=[new ae({image:new ne({fill:n,stroke:i,radius:5}),fill:n,stroke:i})]}return he}function le(t){return t.getGeometry()}var ce="renderOrder",de=function(t){function e(e){var n=e||{},i=j({},n);delete i.style,delete i.renderBuffer,delete i.updateWhileAnimating,delete i.updateWhileInteracting,t.call(this,i),this.declutter_=void 0!==n.declutter&&n.declutter,this.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(n.style),this.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,this.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,this.renderMode_=n.renderMode||Ft,this.type=ft}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.setDeclutter=function(t){this.declutter_=t},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(ce)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(ce,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:ue,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var n;Array.isArray(t)?n=t:(Lt("function"==typeof t.getZIndex,41),n=[t]),e=function(){return n}}return e}(this.style_),this.changed()},e.prototype.getRenderMode=function(){return this.renderMode_},e}(Et);de.prototype.getSource;const pe=de;function fe(t,e,n,i,s){return s?(s[0]=t,s[1]=e,s[2]=n,s[3]=i,s):[t,e,n,i]}function ge(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}const me="arraybuffer",_e="json",ve="text",ye="xml";function Ie(t,e){return function(t,e,n,i){return function(s,o,r){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(s,o,r):t,!0),e.getType()==me&&(a.responseType="arraybuffer"),a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var s,o=e.getType();o==_e||o==ve?s=a.responseText:o==ye?(s=a.responseXML)||(s=(new DOMParser).parseFromString(a.responseText,"application/xml")):o==me&&(s=a.response),s?n.call(this,e.readFeatures(s,{featureProjection:r}),e.readProjection(s),e.getLastExtent()):i.call(this)}else i.call(this)}.bind(this),a.onerror=function(){i.call(this)}.bind(this),a.send()}}(t,e,(function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)}),H)}function Ce(t,e){return[[-1/0,-1/0,1/0,1/0]]}var xe={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},be={};be[xe.DEGREES]=2*Math.PI*6370997/360,be[xe.FEET]=.3048,be[xe.METERS]=1,be[xe.USFEET]=1200/3937;const Pe=xe;var we=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};we.prototype.canWrapX=function(){return this.canWrapX_},we.prototype.getCode=function(){return this.code_},we.prototype.getExtent=function(){return this.extent_},we.prototype.getUnits=function(){return this.units_},we.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||be[this.units_]},we.prototype.getWorldExtent=function(){return this.worldExtent_},we.prototype.getAxisOrientation=function(){return this.axisOrientation_},we.prototype.isGlobal=function(){return this.global_},we.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},we.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},we.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},we.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},we.prototype.setWorldExtent=function(t){this.worldExtent_=t},we.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},we.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};const Se=we;var Ae=6378137,Te=Math.PI*Ae,Ee=[-Te,-Te,Te,Te],Fe=[-180,-85,180,85],Le=function(t){function e(e){t.call(this,{code:e,units:Pe.METERS,extent:Ee,global:!0,worldExtent:Fe,getPointResolution:function(t,e){return t/bt(e[1]/Ae)}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Se),Oe=[new Le("EPSG:3857"),new Le("EPSG:102100"),new Le("EPSG:102113"),new Le("EPSG:900913"),new Le("urn:ogc:def:crs:EPSG:6.18:3:3857"),new Le("urn:ogc:def:crs:EPSG::3857"),new Le("http://www.opengis.net/gml/srs/epsg.xml#3857")];function ke(t,e,n){var i=t.length,s=n>1?n:2,o=e;void 0===o&&(o=s>2?t.slice():new Array(i));for(var r=Te,a=0;a<i;a+=s){o[a]=r*t[a]/180;var h=Ae*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));h>r?h=r:h<-r&&(h=-r),o[a+1]=h}return o}function Me(t,e,n){var i=t.length,s=n>1?n:2,o=e;void 0===o&&(o=s>2?t.slice():new Array(i));for(var r=0;r<i;r+=s)o[r]=180*t[r]/Te,o[r+1]=360*Math.atan(Math.exp(t[r+1]/Ae))/Math.PI-90;return o}var Re=[-180,-90,180,90],De=6378137*Math.PI/180,je=function(t){function e(e,n){t.call(this,{code:e,units:Pe.DEGREES,extent:Re,axisOrientation:n,global:!0,metersPerUnit:De,worldExtent:Re})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Se),Xe=[new je("CRS:84"),new je("EPSG:4326","neu"),new je("urn:ogc:def:crs:EPSG::4326","neu"),new je("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new je("urn:ogc:def:crs:OGC:1.3:CRS84"),new je("urn:ogc:def:crs:OGC:2:84"),new je("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new je("urn:x-ogc:def:crs:EPSG:4326","neu")],Ve={};var Ge,Ke,$e,Be={};function qe(t,e,n){var i=t.getCode(),s=e.getCode();i in Be||(Be[i]={}),Be[i][s]=n}function Ye(t,e,n){var i;if(void 0!==e){for(var s=0,o=t.length;s<o;++s)e[s]=t[s];i=e}else i=t.slice();return i}function We(t){!function(t,e){Ve[t]=e}(t.getCode(),t),qe(t,t,Ye)}function ze(t){return"string"==typeof t?Ve[t]||null:t||null}function Ue(t){!function(t){t.forEach(We)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&qe(e,t,Ye)}))}))}Ue(Oe),Ue(Xe),Ge=Oe,Ke=ke,$e=Me,Xe.forEach((function(t){Ge.forEach((function(e){qe(t,e,Ke),qe(e,t,$e)}))}));var Ne=function(t){function e(e){t.call(this),this.projection_=ze(e.projection),this.attributions_=Je(e.attributions),this.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,this.loading=!1,this.state_=void 0!==e.state?e.state:At,this.wrapX_=void 0!==e.wrapX&&e.wrapX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return E()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=Je(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(ut);function Je(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const He=Ne,Ze="addfeature",Qe="changefeature",tn="clear",en="removefeature";var nn=n(510),sn=n.n(nn),on=function(t){this.rbush_=sn()(t,void 0),this.items_={}};on.prototype.insert=function(t,e){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[L(e)]=n},on.prototype.load=function(t,e){for(var n=new Array(e.length),i=0,s=e.length;i<s;i++){var o=t[i],r=e[i],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:r};n[i]=a,this.items_[L(r)]=a}this.rbush_.load(n)},on.prototype.remove=function(t){var e=L(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)},on.prototype.update=function(t,e){var n=this.items_[L(e)];ge([n.minX,n.minY,n.maxX,n.maxY],t)||(this.remove(e),this.insert(t,e))},on.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},on.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))},on.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},on.prototype.forEachInExtent=function(t,e,n){return this.forEach_(this.getInExtent(t),e,n)},on.prototype.forEach_=function(t,e,n){for(var i,s=0,o=t.length;s<o;s++)if(i=e.call(n,t[s]))return i;return i},on.prototype.isEmpty=function(){return V(this.items_)},on.prototype.clear=function(){this.rbush_.clear(),this.items_={}},on.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return fe(e.minX,e.minY,e.maxX,e.maxY,t)},on.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]};const rn=on;var an=function(t){function e(e,n){t.call(this,e),this.feature=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Q),hn=function(t){function e(e){var n=e||{};t.call(this,{attributions:n.attributions,projection:void 0,state:At,wrapX:void 0===n.wrapX||n.wrapX}),this.loader_=H,this.format_=n.format,this.overlaps_=null==n.overlaps||n.overlaps,this.url_=n.url,void 0!==n.loader?this.loader_=n.loader:void 0!==this.url_&&(Lt(this.format_,7),this.loader_=Ie(this.url_,this.format_)),this.strategy_=void 0!==n.strategy?n.strategy:Ce;var i,s,o=void 0===n.useSpatialIndex||n.useSpatialIndex;this.featuresRtree_=o?new rn:null,this.loadedExtentsRtree_=new rn,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(n.features)?s=n.features:n.features&&(s=(i=n.features).getArray()),o||void 0!==i||(i=new pt(s)),void 0!==s&&this.addFeaturesInternal(s),void 0!==i&&this.bindFeaturesCollection_(i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=L(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var n=t.getGeometry();if(n){var i=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new an(Ze,t))}},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[q(e,nt,this.handleFeatureChange_,this),q(e,D,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var n=!0,i=e.getId();return void 0!==i?i.toString()in this.idIndex_?n=!1:this.idIndex_[i.toString()]=e:(Lt(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),n},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],n=[],i=[],s=0,o=t.length;s<o;s++){var r=t[s],a=L(r);this.addToIndex_(a,r)&&n.push(r)}for(var h=0,u=n.length;h<u;h++){var l=n[h],c=L(l);this.setupChangeEvents_(c,l);var d=l.getGeometry();if(d){var p=d.getExtent();e.push(p),i.push(l)}else this.nullGeometryFeatures_[c]=l}this.featuresRtree_&&this.featuresRtree_.load(e,i);for(var f=0,g=n.length;f<g;f++)this.dispatchEvent(new an(Ze,n[f]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;q(this,Ze,(function(n){e||(e=!0,t.push(n.feature),e=!1)})),q(this,en,(function(n){e||(e=!0,t.remove(n.feature),e=!1)})),q(t,M,(function(t){e||(e=!0,this.addFeature(t.element),e=!1)}),this),q(t,R,(function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}),this),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(z)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_)for(var n in this.featuresRtree_.forEach(this.removeFeatureInternal,this),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var i=new an(tn);this.dispatchEvent(i),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,(function(n){return n.getGeometry().intersectsCoordinate(t)?e(n):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(n){if(n.getGeometry().intersectsExtent(t)){var i=e(n);if(i)return i}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),V(this.nullGeometryFeatures_)||function(t,e){for(var n=Array.isArray(e)?e:[e],i=n.length,s=0;s<i;s++)t[t.length]=n[s]}(t,function(t){var e=[];for(var n in t)e.push(t[n]);return e}(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},e.prototype.getClosestFeatureToCoordinate=function(t,e){var n=t[0],i=t[1],s=null,o=[NaN,NaN],r=1/0,a=[-1/0,-1/0,1/0,1/0],h=e||J;return this.featuresRtree_.forEachInExtent(a,(function(t){if(h(t)){var e=t.getGeometry(),u=r;if((r=e.closestPointXY(n,i,o,r))<u){s=t;var l=Math.sqrt(r);a[0]=n-l,a[1]=i-l,a[2]=n+l,a[3]=i+l}}})),s},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,n=L(e),i=e.getGeometry();if(i){var s=i.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(s,e)):this.featuresRtree_&&this.featuresRtree_.update(s,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);var o=e.getId();if(void 0!==o){var r=o.toString();n in this.undefIdIndex_?(delete this.undefIdIndex_[n],this.idIndex_[r]=e):this.idIndex_[r]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[r]=e)}else n in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[n]=e);this.changed(),this.dispatchEvent(new an(Qe,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:L(t)in this.undefIdIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&V(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,n){var i=this,s=this.loadedExtentsRtree_,o=this.strategy_(t,e);this.loading=!1;for(var r=function(t,r){var a=o[t];s.forEachInExtent(a,(function(t){return e=t.extent,n=a,e[0]<=n[0]&&n[2]<=e[2]&&e[1]<=n[1]&&n[3]<=e[3];var e,n}))||(i.loader_.call(i,a,e,n),s.insert(a,{extent:a.slice()}),i.loading=i.loader_!==H)},a=0,h=o.length;a<h;++a)r(a)},e.prototype.removeLoadedExtent=function(t){var e,n=this.loadedExtentsRtree_;n.forEachInExtent(t,(function(n){if(ge(n.extent,t))return e=n,!0})),e&&n.remove(e)},e.prototype.removeFeature=function(t){var e=L(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=L(t);this.featureChangeKeys_[e].forEach(z),delete this.featureChangeKeys_[e];var n=t.getId();void 0!==n?delete this.idIndex_[n.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new an(en,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var n in this.idIndex_)if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e}(He);const un=hn;const ln=I({mixins:[o],props:{unselectedAnnotations:{type:Array,default:function(){return[]}}},data:function(){return{selectingMaiaAnnotation:!1}},computed:{hasAnnotations:function(){return this.annotations.length>0}},methods:{handlePreviousImage:function(){this.$emit("previous-image")},handleNextImage:function(){this.$emit("next-image")},toggleSelectingMaiaAnnotation:function(){this.selectingMaiaAnnotation=!this.selectingMaiaAnnotation},createUnselectedAnnotationsLayer:function(){this.unselectedAnnotationFeatures=new pt,this.unselectedAnnotationSource=new un({features:this.unselectedAnnotationFeatures}),this.unselectedAnnotationLayer=new pe({source:this.unselectedAnnotationSource,zIndex:99,updateWhileAnimating:!0,updateWhileInteracting:!0,style:y.editing,opacity:.5})},createSelectMaiaAnnotationInteraction:function(t){this.selectMaiaAnnotationInteraction=new a({map:this.map,features:t}),this.selectMaiaAnnotationInteraction.setActive(!1),this.selectMaiaAnnotationInteraction.on("attach",this.handleSelectMaiaAnnotation)},handleSelectMaiaAnnotation:function(t){this.$emit("select",t.feature.get("annotation"))},handleUnselectMaiaAnnotation:function(){!this.modifyInProgress&&this.selectedAnnotations.length>0&&this.$emit("unselect",this.selectedAnnotations[0])}},watch:{unselectedAnnotations:function(t){this.refreshAnnotationSource(t,this.unselectedAnnotationSource)},selectingMaiaAnnotation:function(t){this.selectMaiaAnnotationInteraction.setActive(t)}},created:function(){this.createUnselectedAnnotationsLayer(),this.map.addLayer(this.unselectedAnnotationLayer),this.selectInteraction.setActive(!1),this.canModify&&(this.createSelectMaiaAnnotationInteraction(this.unselectedAnnotationFeatures),this.map.addInteraction(this.selectMaiaAnnotationInteraction),d.on("Delete",this.handleUnselectMaiaAnnotation,0,this.listenerSet)),d.off("Shift+f",this.toggleMeasuring,this.listenerSet)},mounted:function(){d.off("m",this.toggleTranslating,this.listenerSet)}},undefined,undefined,!1,null,null,null).exports;const cn=I({mixins:[ln],props:{convertedAnnotations:{type:Array,default:function(){return[]}}},methods:{createConvertedAnnotationsLayer:function(){this.convertedAnnotationFeatures=new pt,this.convertedAnnotationSource=new un({features:this.convertedAnnotationFeatures});var t=new ut;t.set("color","999999"),this.convertedAnnotationLayer=new pe({source:this.convertedAnnotationSource,zIndex:98,updateWhileAnimating:!0,updateWhileInteracting:!0,style:y.features(t)})}},watch:{convertedAnnotations:function(t){this.refreshAnnotationSource(t,this.convertedAnnotationSource)}},created:function(){this.createConvertedAnnotationsLayer(),this.map.addLayer(this.convertedAnnotationLayer)}},undefined,undefined,!1,null,null,null).exports;const dn=I({components:{labelTrees:p},props:{selectedCandidates:{type:Array,required:!0},labelTrees:{type:Array,required:!0},loading:{type:Boolean,default:!1}},computed:{hasNoSelectedCandidates:function(){return 0===this.selectedCandidates.length}},methods:{handleSelectedLabel:function(t){this.$emit("select",t)},handleDeselectedLabel:function(){this.$emit("select",null)},handleConvertCandidates:function(){this.hasNoSelectedCandidates||this.$emit("convert")}}},undefined,undefined,!1,null,null,null).exports;const pn=I({props:{selectedProposals:{type:Array,required:!0},seenProposals:{type:Array,required:!0}},computed:{numberSelectedProposals:function(){return this.selectedProposals.length},numberSeenProposals:function(){return this.seenProposals.length},hasNoSelectedProposals:function(){return 0===this.numberSelectedProposals},hasSeenAllSelectedProposals:function(){return this.numberSelectedProposals>0&&this.numberSelectedProposals===this.numberSeenProposals},textClass:function(){return this.hasSeenAllSelectedProposals?"text-success":""},buttonClass:function(){return this.hasSeenAllSelectedProposals?"btn-success":"btn-default"}}},undefined,undefined,!1,null,null,null).exports;const fn=I({components:{labelTrees:p},props:{labelTrees:{type:Array,required:!0}},methods:{handleSelectedLabel:function(t){this.$emit("select",t)},handleDeselectedLabel:function(){this.$emit("select",null)},proceed:function(){this.$emit("proceed")}}},undefined,undefined,!1,null,null,null).exports;const gn=I({props:{proposals:{type:Array,required:!0},selectedProposals:{type:Array,required:!0}},computed:{selectedProposalsCount:function(){return this.selectedProposals.length},proposalsCount:function(){return this.proposals.length}},methods:{proceed:function(){this.$emit("proceed")}}},undefined,undefined,!1,null,null,null).exports;var mn=[],_n={},vn=[],yn={};const In=I({mixins:[g],components:{sidebar:_,sidebarTab:v,selectProposalsTab:gn,proposalsImageGrid:T,refineProposalsTab:pn,refineCanvas:ln,refineCandidatesCanvas:cn,selectCandidatesTab:fn,candidatesImageGrid:P,refineCandidatesTab:dn},data:function(){return{job:null,states:null,labelTrees:[],visitedSelectProposalsTab:!1,visitedRefineProposalsTab:!1,visitedSelectCandidatesTab:!1,visitedRefineCandidatesTab:!1,openTab:"info",fetchProposalsPromise:null,hasProposals:!1,selectedProposalIds:{},seenProposalIds:{},lastSelectedProposal:null,currentProposalImage:null,currentProposalImageIndex:null,currentProposals:[],currentProposalsById:{},focussedProposal:null,proposalAnnotationCache:{},fetchCandidatesPromise:null,hasCandidates:!1,selectedCandidateIds:{},convertedCandidateIds:{},lastSelectedCandidate:null,currentCandidateImage:null,currentCandidateImageIndex:null,currentCandidates:[],currentCandidatesById:{},focussedCandidate:null,candidateAnnotationCache:{},selectedLabel:null,sequenceCounter:0}},computed:{infoTabOpen:function(){return"info"===this.openTab},selectProposalsTabOpen:function(){return"select-proposals"===this.openTab},refineProposalsTabOpen:function(){return"refine-proposals"===this.openTab},selectCandidatesTabOpen:function(){return"select-candidates"===this.openTab},refineCandidatesTabOpen:function(){return"refine-candidates"===this.openTab},isInTrainingProposalState:function(){return this.job.state_id===this.states["training-proposals"]},isInAnnotationCandidateState:function(){return this.job.state_id===this.states["annotation-candidates"]},proposals:function(){return this.hasProposals?mn:[]},selectedProposals:function(){var t=this.selectedProposalIds;return Object.keys(t).map((function(t){return _n[t]})).sort((function(e,n){return e.image_id===n.image_id?t[e.id]-t[n.id]:e.image_id-n.image_id}))},proposalsForSelectView:function(){return this.isInTrainingProposalState?this.proposals:this.selectedProposals},hasSelectedProposals:function(){return this.selectedProposals.length>0},proposalImageIds:function(){var t={};return this.proposals.forEach((function(e){return t[e.image_id]=void 0})),Object.keys(t).map((function(t){return parseInt(t,10)}))},currentProposalImageId:function(){return this.proposalImageIds[this.currentProposalImageIndex]},nextProposalImageIndex:function(){return(this.currentProposalImageIndex+1)%this.proposalImageIds.length},nextProposalImageId:function(){return this.proposalImageIds[this.nextProposalImageIndex]},nextFocussedProposalImageId:function(){return this.nextFocussedProposal?this.nextFocussedProposal.image_id:this.nextProposalImageId},previousProposalImageIndex:function(){return(this.currentProposalImageIndex-1+this.proposalImageIds.length)%this.proposalImageIds.length},previousProposalImageId:function(){return this.proposalImageIds[this.previousProposalImageIndex]},hasCurrentProposalImage:function(){return null!==this.currentProposalImage},currentSelectedProposals:function(){var t=this;return this.currentProposals.filter((function(e){return t.selectedProposalIds.hasOwnProperty(e.id)}))},currentUnselectedProposals:function(){var t=this;return this.currentProposals.filter((function(e){return!t.selectedProposalIds.hasOwnProperty(e.id)}))},previousFocussedProposal:function(){var t=(this.selectedProposals.indexOf(this.focussedProposal)-1+this.selectedProposals.length)%this.selectedProposals.length;return this.selectedProposals[t]},nextFocussedProposal:function(){var t=(this.selectedProposals.indexOf(this.focussedProposal)+1)%this.selectedProposals.length;return this.selectedProposals[t]},focussedProposalToShow:function(){return this.refineProposalsTabOpen?this.focussedProposal:null},focussedProposalArray:function(){var t=this;return this.focussedProposalToShow?this.currentSelectedProposals.filter((function(e){return e.id===t.focussedProposalToShow.id})):[]},selectedAndSeenProposals:function(){var t=this;return this.selectedProposals.filter((function(e){return t.seenProposalIds.hasOwnProperty(e.id)}))},candidates:function(){return this.hasCandidates?vn:[]},selectedCandidates:function(){var t=this.selectedCandidateIds;return Object.keys(t).map((function(t){return yn[t]})).sort((function(e,n){return e.image_id===n.image_id?t[e.id]-t[n.id]:e.image_id-n.image_id}))},hasSelectedCandidates:function(){return this.selectedCandidates.length>0},candidateImageIds:function(){var t={};return this.candidates.forEach((function(e){return t[e.image_id]=void 0})),Object.keys(t).map((function(t){return parseInt(t,10)}))},currentCandidateImageId:function(){return this.candidateImageIds[this.currentCandidateImageIndex]},nextCandidateImageIndex:function(){return(this.currentCandidateImageIndex+1)%this.candidateImageIds.length},nextCandidateImageId:function(){return this.candidateImageIds[this.nextCandidateImageIndex]},previousCandidateImageIndex:function(){return(this.currentCandidateImageIndex-1+this.candidateImageIds.length)%this.candidateImageIds.length},previousCandidateImageId:function(){return this.candidateImageIds[this.previousCandidateImageIndex]},hasCurrentCandidateImage:function(){return null!==this.currentCandidateImage},currentSelectedCandidates:function(){var t=this;return this.currentCandidates.filter((function(e){return t.selectedCandidateIds.hasOwnProperty(e.id)}))},currentUnselectedCandidates:function(){var t=this;return this.currentCandidates.filter((function(e){return!t.selectedCandidateIds.hasOwnProperty(e.id)&&!t.convertedCandidateIds.hasOwnProperty(e.id)}))},currentConvertedCandidates:function(){var t=this;return this.currentCandidates.filter((function(e){return t.convertedCandidateIds.hasOwnProperty(e.id)}))},previousFocussedCandidate:function(){var t=(this.selectedCandidates.indexOf(this.focussedCandidate)-1+this.selectedCandidates.length)%this.selectedCandidates.length;return this.selectedCandidates[t]},nextFocussedCandidate:function(){var t=(this.selectedCandidates.indexOf(this.focussedCandidate)+1)%this.selectedCandidates.length;return this.selectedCandidates[t]},nextFocussedCandidateImageId:function(){return this.nextFocussedCandidate?this.nextFocussedCandidate.image_id:this.nextCandidateImageId},focussedCandidateToShow:function(){return this.refineCandidatesTabOpen?this.focussedCandidate:null},focussedCandidateArray:function(){var t=this;return this.focussedCandidateToShow?this.currentSelectedCandidates.filter((function(e){return e.id===t.focussedCandidateToShow.id})):[]}},methods:{handleSidebarToggle:function(){var t=this;this.$nextTick((function(){t.$refs.proposalsImageGrid&&t.$refs.proposalsImageGrid.$emit("resize"),t.$refs.candidatesImageGrid&&t.$refs.candidatesImageGrid.$emit("resize")}))},handleTabOpened:function(t){this.openTab=t},setProposals:function(t){var e=this;(mn=t.body).forEach((function(t){_n[t.id]=t,e.setSelectedProposalId(t)})),this.hasProposals=mn.length>0},fetchProposals:function(){return this.fetchProposalsPromise||(this.startLoading(),this.fetchProposalsPromise=w.getTrainingProposals({id:this.job.id}),this.fetchProposalsPromise.then(this.setProposals,h).finally(this.finishLoading)),this.fetchProposalsPromise},openRefineProposalsTab:function(){this.openTab="refine-proposals"},openRefineCandidatesTab:function(){this.openTab="refine-candidates"},updateSelectProposal:function(t,e){var n=this;t.selected=e,this.setSelectedProposalId(t);var i=S.update({id:t.id},{selected:e});return i.catch((function(i){h(i),t.selected=!e,n.setSelectedProposalId(t)})),i},setSelectedProposalId:function(t){t.selected?Vue.set(this.selectedProposalIds,t.id,this.getSequenceId()):Vue.delete(this.selectedProposalIds,t.id)},setSeenProposalId:function(t){Vue.set(this.seenProposalIds,t.id,!0)},fetchProposalAnnotations:function(t){return this.proposalAnnotationCache.hasOwnProperty(t)||(this.proposalAnnotationCache[t]=w.getTrainingProposalPoints({jobId:this.job.id,imageId:t}).then(this.parseAnnotations)),this.proposalAnnotationCache[t]},parseAnnotations:function(t){return Object.keys(t.body).map((function(e){return{id:parseInt(e,10),shape:"Circle",points:t.body[e]}}))},setCurrentProposalImageAndAnnotations:function(t){var e=this;this.currentProposalImage=t[0],this.currentProposals=t[1],this.currentProposalsById={},this.currentProposals.forEach((function(t){e.currentProposalsById[t.id]=t}))},cacheNextProposalImage:function(){this.currentProposalImageId!==this.nextFocussedProposalImageId&&c.fetchImage(this.nextFocussedProposalImageId).catch((function(){}))},cacheNextProposalAnnotations:function(){this.currentProposalImageId!==this.nextFocussedProposalImageId&&this.fetchProposalAnnotations(this.nextFocussedProposalImageId).catch((function(){}))},handlePreviousProposalImage:function(){this.currentProposalImageIndex=this.previousProposalImageIndex},handlePreviousProposal:function(){this.previousFocussedProposal?this.focussedProposal=this.previousFocussedProposal:this.handlePreviousProposalImage()},handleNextProposalImage:function(){this.currentProposalImageIndex=this.nextProposalImageIndex},handleNextProposal:function(){this.nextFocussedProposal?this.focussedProposal=this.nextFocussedProposal:this.handleNextProposalImage()},handleRefineProposal:function(t){Vue.Promise.all(t.map(this.updateProposalPoints)).catch(h)},updateProposalPoints:function(t){var e=this.currentProposalsById[t.id];return S.update({id:t.id},{points:t.points}).then((function(){e.points=t.points}))},focusProposalToShow:function(){if(this.focussedProposalToShow){var t=this.currentProposalsById[this.focussedProposalToShow.id];t&&this.$refs.refineProposalsCanvas.focusAnnotation(t,!0,!1)}},handleSelectedProposal:function(t,e){t.selected?this.unselectProposal(t):e.shiftKey&&this.lastSelectedProposal?this.doForEachBetween(this.proposals,t,this.lastSelectedProposal,this.selectProposal):(this.lastSelectedProposal=t,this.selectProposal(t))},selectProposal:function(t){this.updateSelectProposal(t,!0).then(this.maybeInitFocussedProposal)},unselectProposal:function(t){var e=this.nextFocussedProposal;this.updateSelectProposal(t,!1).bind(this).then((function(){this.maybeUnsetFocussedProposal(t,e)}))},maybeInitFocussedProposal:function(){!this.focussedProposal&&this.hasSelectedProposals&&(this.focussedProposal=this.selectedProposals[0])},maybeUnsetFocussedProposal:function(t,e){this.focussedProposal&&this.focussedProposal.id===t.id&&(e&&e.id!==t.id?this.focussedProposal=e:this.focussedProposal=null)},maybeInitCurrentProposalImage:function(){null===this.currentProposalImageIndex&&(this.currentProposalImageIndex=0)},maybeInitCurrentCandidateImage:function(){null===this.currentCandidateImageIndex&&(this.currentCandidateImageIndex=0)},handleLoadingError:function(t){m.danger(t)},setSelectedCandidateId:function(t){t.label&&!t.annotation_id?Vue.set(this.selectedCandidateIds,t.id,this.getSequenceId()):Vue.delete(this.selectedCandidateIds,t.id)},setConvertedCandidateId:function(t){t.annotation_id?Vue.set(this.convertedCandidateIds,t.id,t.annotation_id):Vue.delete(this.convertedCandidateIds,t.id)},setCandidates:function(t){var e=this;(vn=t.body).forEach((function(t){yn[t.id]=t,e.setSelectedCandidateId(t),e.setConvertedCandidateId(t)})),this.hasCandidates=vn.length>0},fetchCandidates:function(t){return this.fetchCandidatesPromise&&!t||(this.startLoading(),this.fetchCandidatesPromise=w.getAnnotationCandidates({id:this.job.id}),this.fetchCandidatesPromise.then(this.setCandidates,h).finally(this.finishLoading)),this.fetchCandidatesPromise},handleSelectedCandidate:function(t,e){t.label?this.unselectCandidate(t):e.shiftKey&&this.lastSelectedCandidate&&this.selectedLabel?this.doForEachBetween(this.candidates,t,this.lastSelectedCandidate,this.selectCandidate):(this.lastSelectedCandidate=t,this.selectCandidate(t))},selectCandidate:function(t){this.selectedLabel?t.annotation_id||this.updateSelectCandidate(t,this.selectedLabel).then(this.maybeInitFocussedCandidate):m.info("Please select a label first.")},unselectCandidate:function(t){var e=this.nextFocussedCandidate;this.updateSelectCandidate(t,null).bind(this).then((function(){this.maybeUnsetFocussedCandidate(t,e)}))},updateSelectCandidate:function(t,e){var n=this,i=t.label;t.label=e,this.setSelectedCandidateId(t);var s=e?e.id:null,o=x.update({id:t.id},{label_id:s});return o.catch((function(e){h(e),t.label=i,n.setSelectedCandidateId(t)})),o},fetchCandidateAnnotations:function(t){return this.candidateAnnotationCache.hasOwnProperty(t)||(this.candidateAnnotationCache[t]=w.getAnnotationCandidatePoints({jobId:this.job.id,imageId:t}).then(this.parseAnnotations)),this.candidateAnnotationCache[t]},setCurrentCandidateImageAndAnnotations:function(t){var e=this;this.currentCandidateImage=t[0],this.currentCandidates=t[1],this.currentCandidatesById={},this.currentCandidates.forEach((function(t){return e.currentCandidatesById[t.id]=t}))},handlePreviousCandidateImage:function(){this.currentCandidateImageIndex=this.previousCandidateImageIndex},handlePreviousCandidate:function(){this.previousFocussedCandidate?this.focussedCandidate=this.previousFocussedCandidate:this.handlePreviousCandidateImage()},handleNextCandidateImage:function(){this.currentCandidateImageIndex=this.nextCandidateImageIndex},handleNextCandidate:function(){this.nextFocussedCandidate?this.focussedCandidate=this.nextFocussedCandidate:this.handleNextCandidateImage()},focusCandidateToShow:function(){if(this.focussedCandidateToShow){var t=this.currentCandidatesById[this.focussedCandidateToShow.id];t&&this.$refs.refineCandidatesCanvas.focusAnnotation(t,!0,!1)}},maybeInitFocussedCandidate:function(){!this.focussedCandidate&&this.hasSelectedCandidates&&(this.focussedCandidate=this.selectedCandidates[0])},maybeUnsetFocussedCandidate:function(t,e){this.focussedCandidate&&this.focussedCandidate.id===t.id&&(e&&e.id!==t.id?this.focussedCandidate=e:this.focussedCandidate=null)},handleSelectedLabel:function(t){this.selectedLabel=t},doForEachBetween:function(t,e,n,i){var s=t.indexOf(e),o=t.indexOf(n);if(o<s){var r=o;o=s,s=r+1}else o-=1;for(var a=s;a<=o;a++)i(t[a])},cacheNextCandidateImage:function(){this.currentCandidateImageId!==this.nextFocussedCandidateImageId&&c.fetchImage(this.nextFocussedCandidateImageId).catch((function(){}))},cacheNextCandidateAnnotations:function(){this.currentCandidateImageId!==this.nextFocussedCandidateImageId&&this.fetchCandidateAnnotations(this.nextFocussedCandidateImageId).catch((function(){}))},handleRefineCandidate:function(t){Vue.Promise.all(t.map(this.updateCandidatePoints)).catch(h)},updateCandidatePoints:function(t){var e=this.currentCandidatesById[t.id];return x.update({id:t.id},{points:t.points}).then((function(){return e.points=t.points}))},handleConvertCandidates:function(){this.startLoading(),w.convertAnnotationCandidates({id:this.job.id},{}).then(this.waitForConvertedCandidates)},waitForConvertedCandidates:function(){var t=this;!function e(){window.setTimeout((function(){w.convertingAnnotationCandidates({id:t.job.id}).then(e,t.handleConvertedCandidates)}),2e3)}()},handleConvertedCandidates:function(t){var e=this;if(404===t.status)return this.fetchCandidates(!0).then((function(){var t=e.nextFocussedCandidate;e.candidates.map((function(n){return e.maybeUnsetFocussedCandidate(n,t)}))})).then(this.finishLoading);h(t),this.finishLoading()},getSequenceId:function(){return this.sequenceCounter++}},watch:{selectProposalsTabOpen:function(t){this.visitedSelectProposalsTab=!0,t&&d.setActiveSet("select-proposals")},refineProposalsTabOpen:function(t){this.visitedRefineProposalsTab=!0,t&&(d.setActiveSet("refine-proposals"),this.maybeInitFocussedProposal())},selectCandidatesTabOpen:function(t){this.visitedSelectCandidatesTab=!0,t&&d.setActiveSet("select-candidates")},refineCandidatesTabOpen:function(t){this.visitedRefineCandidatesTab=!0,t&&d.setActiveSet("refine-candidates")},visitedSelectProposalsTab:function(){this.fetchProposals()},visitedRefineProposalsTab:function(){this.fetchProposals().then(this.maybeInitFocussedProposal).then(this.maybeInitCurrentProposalImage)},visitedSelectCandidatesTab:function(){this.fetchCandidates()},visitedRefineCandidatesTab:function(){this.fetchCandidates().then(this.maybeInitFocussedCandidate).then(this.maybeInitCurrentCandidateImage)},currentProposalImageId:function(t){t?(this.startLoading(),Vue.Promise.all([c.fetchAndDrawImage(t),this.fetchProposalAnnotations(t),this.fetchProposals()]).then(this.setCurrentProposalImageAndAnnotations).then(this.focusProposalToShow).then(this.cacheNextProposalImage).then(this.cacheNextProposalAnnotations).catch(this.handleLoadingError).finally(this.finishLoading)):this.setCurrentProposalImageAndAnnotations([null,null])},focussedProposalToShow:function(t,e){t&&(e&&e.image_id===t.image_id?this.focusProposalToShow():this.currentProposalImageIndex=this.proposalImageIds.indexOf(t.image_id),this.setSeenProposalId(t))},currentCandidateImageId:function(t){t?(this.startLoading(),Vue.Promise.all([c.fetchAndDrawImage(t),this.fetchCandidateAnnotations(t),this.fetchCandidates()]).then(this.setCurrentCandidateImageAndAnnotations).then(this.focusCandidateToShow).then(this.cacheNextCandidateImage).then(this.cacheNextCandidateAnnotations).catch(this.handleLoadingError).finally(this.finishLoading)):this.setCurrentCandidateImageAndAnnotations([null,null])},focussedCandidateToShow:function(t,e){t&&(e&&e.image_id===t.image_id?this.focusCandidateToShow():this.currentCandidateImageIndex=this.candidateImageIds.indexOf(t.image_id))}},created:function(){this.job=biigle.$require("maia.job"),this.states=biigle.$require("maia.states"),this.labelTrees=biigle.$require("maia.labelTrees")}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("maia-job-form",C),biigle.$mount("maia-show-container",In)},401:()=>{},166:function(t){t.exports=function(){"use strict";function t(t,n,s,o,r){e(t,n,s||0,o||t.length-1,r||i)}function e(t,i,s,o,r){for(;o>s;){if(o-s>600){var a=o-s+1,h=i-s+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(h-a/2<0?-1:1);e(t,i,Math.max(s,Math.floor(i-h*l/a+c)),Math.min(o,Math.floor(i+(a-h)*l/a+c)),r)}var d=t[i],p=s,f=o;for(n(t,s,i),r(t[o],d)>0&&n(t,s,o);p<f;){for(n(t,p,f),p++,f--;r(t[p],d)<0;)p++;for(;r(t[f],d)>0;)f--}0===r(t[s],d)?n(t,s,f):n(t,++f,o),f<=i&&(s=f+1),i<=f&&(o=f-1)}}function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:t>e?1:0}return t}()},510:(t,e,n)=>{"use strict";t.exports=s,t.exports.default=s;var i=n(166);function s(t,e){if(!(this instanceof s))return new s(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function r(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,i,s){s||(s=g(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var o,r=e;r<n;r++)o=t.children[r],h(s,t.leaf?i(o):o);return s}function h(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,n,s,o){for(var r,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=s||(r=e+Math.ceil((n-e)/s/2)*s,i(t,r,e,n,o),a.push(e,r,r,n))}s.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!f(t,e))return n;for(var s,o,r,a,h=[];e;){for(s=0,o=e.children.length;s<o;s++)r=e.children[s],f(t,a=e.leaf?i(r):r)&&(e.leaf?n.push(r):p(t,a)?this._all(r,n):h.push(r));e=h.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!f(t,e))return!1;for(var i,s,o,r,a=[];e;){for(i=0,s=e.children.length;i<s;i++)if(o=e.children[i],f(t,r=e.leaf?n(o):o)){if(e.leaf||p(t,r))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var s=this.data;this.data=i,i=s}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var n,i,s,r,a=this.data,h=this.toBBox(t),u=[],l=[];a||u.length;){if(a||(a=u.pop(),i=u[u.length-1],n=l.pop(),r=!0),a.leaf&&-1!==(s=o(t,a.children,e)))return a.children.splice(s,1),u.push(a),this._condense(u),this;r||a.leaf||!p(a,h)?i?(n++,a=i.children[n],r=!1):a=null:(u.push(a),l.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var s,o=n-e+1,a=this._maxEntries;if(o<=a)return r(s=g(t.slice(e,n+1)),this.toBBox),s;i||(i=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,i-1))),(s=g([])).leaf=!1,s.height=i;var h,u,l,c,d=Math.ceil(o/a),p=d*Math.ceil(Math.sqrt(a));for(m(t,e,n,p,this.compareMinX),h=e;h<=n;h+=p)for(m(t,h,l=Math.min(h+p-1,n),d,this.compareMinY),u=h;u<=l;u+=d)c=Math.min(u+d-1,l),s.children.push(this._build(t,u,c,i-1));return r(s,this.toBBox),s},_chooseSubtree:function(t,e,n,i){for(var s,o,r,a,h,u,l,d,p,f;i.push(e),!e.leaf&&i.length-1!==n;){for(l=d=1/0,s=0,o=e.children.length;s<o;s++)h=c(r=e.children[s]),p=t,f=r,(u=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-h)<d?(d=u,l=h<l?h:l,a=r):u===d&&h<l&&(l=h,a=r);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,s=n?t:i(t),o=[],r=this._chooseSubtree(s,this.data,e,o);for(r.children.push(t),h(r,s);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(s,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,i);var o=this._chooseSplitIndex(n,s,i),a=g(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,r(n,this.toBBox),r(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,s,o,r,h,u,l,d,p,f,g,m,_,v;for(u=l=1/0,i=e;i<=n-e;i++)s=a(t,0,i,this.toBBox),o=a(t,i,n,this.toBBox),p=s,f=o,g=void 0,m=void 0,_=void 0,v=void 0,g=Math.max(p.minX,f.minX),m=Math.max(p.minY,f.minY),_=Math.min(p.maxX,f.maxX),v=Math.min(p.maxY,f.maxY),r=Math.max(0,_-g)*Math.max(0,v-m),h=c(s)+c(o),r<u?(u=r,d=i,l=h<l?h:l):r===u&&h<l&&(l=h,d=i);return d},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:u,s=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,s)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var s,o,r=this.toBBox,u=a(t,0,e,r),l=a(t,n-e,n,r),c=d(u)+d(l);for(s=e;s<n-e;s++)o=t.children[s],h(u,t.leaf?r(o):o),c+=d(u);for(s=n-e-1;s>=e;s--)o=t.children[s],h(l,t.leaf?r(o):o),c+=d(l);return c},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)h(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():r(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}}},n={};function i(t){var s=n[t];if(void 0!==s)return s.exports;var o=n[t]={exports:{}};return e[t].call(o.exports,o,o.exports,i),o.exports}i.m=e,t=[],i.O=(e,n,s,o)=>{if(!n){var r=1/0;for(l=0;l<t.length;l++){for(var[n,s,o]=t[l],a=!0,h=0;h<n.length;h++)(!1&o||r>=o)&&Object.keys(i.O).every((t=>i.O[t](n[h])))?n.splice(h--,1):(a=!1,o<r&&(r=o));if(a){t.splice(l--,1);var u=s();void 0!==u&&(e=u)}}return e}o=o||0;for(var l=t.length;l>0&&t[l-1][2]>o;l--)t[l]=t[l-1];t[l]=[n,s,o]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={355:0,392:0};i.O.j=e=>0===t[e];var e=(e,n)=>{var s,o,[r,a,h]=n,u=0;if(r.some((e=>0!==t[e]))){for(s in a)i.o(a,s)&&(i.m[s]=a[s]);if(h)var l=h(i)}for(e&&e(n);u<r.length;u++)o=r[u],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(l)},n=self.webpackChunkbiigle_maia=self.webpackChunkbiigle_maia||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),i.O(void 0,[392],(()=>i(566)));var s=i.O(void 0,[392],(()=>i(401)));s=i.O(s)})();